<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Home</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial; margin:0; background:#0b0f17; color:#e6edf3}
    .wrap{max-width:1200px; margin:0 auto; padding:18px}
    .grid{display:grid; grid-template-columns: 1.2fr 1.6fr 1.2fr; gap:14px}
    .card{background:#111827; border:1px solid #1f2937; border-radius:14px; padding:14px; box-shadow: 0 8px 20px rgba(0,0,0,.25)}
    h2{margin:0 0 10px; font-size:16px}
    h3{margin:12px 0 8px; font-size:14px; opacity:.9}
    a{color:#7dd3fc; text-decoration:none}
    a:hover{text-decoration:underline}
    ul{margin:0; padding-left:18px}
    .muted{opacity:.6; font-size:12px}
    input{width:100%; box-sizing:border-box; border-radius:12px; padding:12px 12px; border:1px solid #334155; background:#0b1220; color:#e6edf3}
    .btns{display:flex; gap:10px; margin-top:10px; flex-wrap:wrap}
    button{border-radius:12px; padding:10px 12px; border:1px solid #334155; background:#0b1220; color:#e6edf3; cursor:pointer}
    button:hover{background:#0f1a30}
    @media (max-width: 980px){ .grid{grid-template-columns:1fr} }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="grid">
      <div class="card">
        <h2>ğŸ” æœç´¢</h2>
        <input id="q" placeholder="è¾“å…¥å…³é”®è¯ï¼Œå›è½¦æœç´¢â€¦" />
        <div class="btns">
          <button onclick="go('google')">Google</button>
          <button onclick="go('bili')">Bç«™</button>
          <button onclick="go('yt')">YouTube</button>
        </div>
        <p class="muted">æç¤ºï¼šåç»­æˆ‘å¯ä»¥å¸®ä½ æŠŠå¸¸ç”¨ç½‘ç«™åšæˆå¯æ‹–æ‹½åˆ†ç»„ä¹¦ç­¾ ğŸ˜Š</p>
      </div>

      <div class="card" id="liveCard">
        <h2>ğŸ“º å¼€æ’­ç›‘æ§</h2>
        <div class="muted">æ­£åœ¨åŠ è½½â€¦</div>
      </div>

      <div class="card">
        <h2>ğŸ§© é¢„ç•™æ¨¡å—</h2>
        <ul>
          <li>ğŸ“° çƒ­æ¦œ</li>
          <li>âœ… å¾…åŠ</li>
          <li>ğŸŒ¦ï¸ å¤©æ°”</li>
          <li>ğŸ’» Homelab çŠ¶æ€</li>
        </ul>
        <p class="muted">ä½ æƒ³ä¼˜å…ˆåŠ å“ªä¸ªæ¨¡å—ï¼Ÿæˆ‘æŒ‰ä½ éœ€æ±‚ä¸€æ­¥æ­¥è¡¥ä¸Šã€‚</p>
      </div>
    </div>
  </div>

<script>
function go(engine){
  const q = document.getElementById('q').value.trim();
  if(!q) return;
  const m = {
    google: `https://www.google.com/search?q=${encodeURIComponent(q)}`,
    bili: `https://search.bilibili.com/all?keyword=${encodeURIComponent(q)}`,
    yt: `https://www.youtube.com/results?search_query=${encodeURIComponent(q)}`
  };
  window.open(m[engine], '_blank');
}
document.getElementById('q').addEventListener('keydown', (e)=>{
  if(e.key === 'Enter') go('google');
});

async function refreshLive(){
  const box = document.getElementById('liveCard');
  try{
    const r = await fetch('/api/live', { cache: 'no-store' });
    const data = await r.json();

    const liveBili = (data.bili || []).filter(x => x.live_status === 1);
    const liveYT   = (data.youtube || []).filter(x => x.eventType === 'live');
    const upYT     = (data.youtube || []).filter(x => x.eventType === 'upcoming');

    box.innerHTML = `
      <h2>ğŸ“º å¼€æ’­ç›‘æ§</h2>

      <h3>ğŸ”´ æ­£åœ¨ç›´æ’­ï¼ˆBç«™ï¼‰</h3>
      <ul>${liveBili.map(x => `<li><a href="${x.url}" target="_blank">${x.uname || 'Bç«™ä¸»æ’­'}ï¼š${x.title || 'ï¼ˆæ— æ ‡é¢˜ï¼‰'}</a></li>`).join('') || '<li>æš‚æ— </li>'}</ul>

      <h3>ğŸ”´ æ­£åœ¨ç›´æ’­ï¼ˆYouTubeï¼‰</h3>
      <ul>${liveYT.map(x => `<li><a href="${x.url}" target="_blank">${x.channelTitle}ï¼š${x.title}</a></li>`).join('') || '<li>æš‚æ— </li>'}</ul>

      <h3>â³ ç›´æ’­é¢„å‘Šï¼ˆYouTubeï¼‰</h3>
      <ul>${upYT.map(x => `<li><a href="${x.url}" target="_blank">${x.channelTitle}ï¼š${x.title}</a></li>`).join('') || '<li>æš‚æ— </li>'}</ul>

      <div class="muted">æ›´æ–°ï¼š${data.updated_at}</div>
    `;
  }catch(e){
    box.innerHTML = `<h2>ğŸ“º å¼€æ’­ç›‘æ§</h2><div class="muted">åŠ è½½å¤±è´¥ï¼š${String(e)}</div>`;
  }
}
refreshLive();
setInterval(refreshLive, 60_000);
</script>
</body>
</html>
